---
title: 感知器编写相关问题
date: 2017-07-05 23:20:54
tags: [python,python3,深度学习,学习笔记]
---


---
<font style="color: rgb(172,168,167)">注：转载请注明出处以及作者，违者必究。</font>
### 前景提要

最近在[学习零基础入门深度学习](https://www.zybuluo.com/hanbingtao/note/433855) ，然后跟着上面的代码敲了一遍。在运行的时候遇到诸多问题。文章中的代码都是 python2 的，但是我电脑上配置的环境是 python3 的，可怕的是，我还没学 python3 看的都是 python2 ，所以只有慢慢 debug 了~ （最快的方法是用 py2 运行，但是想的还可以学下 py3 何乐而不为呢）





### 问题汇总

<!--more-->
 > * [使用()给 lambda 函数传入参数报错](#jump_1)
 > * [print 问题](#jump_2)
 > * [reduce 、map 等相关问题](#jump_3)

<br />


### <span id ="jump_1">问题 1 </span> 使用( )给 lambda 函数传入参数报错 

在代码中，我按照作者所写代码，使用了 lambda (x,w):x*w,... 运行时，报错如下：
```
SyntaxError:invalid syntax 
```
在网上搜了一圈，在 [stackoverflow](https://stackoverflow.com/questions/15712210/python-3-2-lambda-syntax-error) (原文参考) 知道了答案。回答中说，python3 不允许使用()给 lambda 函数传入参数，并说可以去 [PEP-3113](https://www.python.org/dev/peps/pep-3113/) (讲的是 Removal of Tuple Parameter Unpacking ，百度翻译是“元组参数解包的移除”) 看原因。大概就内省问题，去掉不会有什么影响，还有tuple和其他比是个例外规则等等（本博英语欠佳，所以原因大家还是自己看吧）。
下面是一个把 py2 改写成 py3 的例子
```python
#py2: 
  lambda (x, y): x + y
#py3:
  lambda x_y: x_y[0] + x_y[1]
```
通俗的说就是：
```python
lambda (param1, param2): param1 op param2
#改写成
lambda param1_param2: param1_param2[0] op param1_param2[1]
```


<br />


### <span id ="jump_2">问题 2</span> print 问题

打印了一个对象，对象中定义了 
```
__str__
```
 如下：
```python
def __str__(self):
  '''
  打印学习到的权重、偏置项
  '''
  return 'weights\t:%s\nbias\t:%f\n' % (self.weights, self.bias)
```
直接打印时（ print and_perceptron ）报错：
```
SyntaxError: Missing parentheses in call to 'print'
```
搜了下网上说 py3 的 print 需要加 ( )。 遂把所有的 print 都加上了 ( )，然后报了另外的错，也是print的。
```python
print ('1 and 1 = %d') % and_perceptron.predict([1, 1])
print ('0 and 0 = %d') % and_perceptron.predict([0, 0])
print ('1 and 0 = %d') % and_perceptron.predict([1, 0])
print ('0 and 1 = %d') % and_perceptron.predict([0, 1])
```
报错如下：
```
print ('1 and 1 = %d') % and_perceptron.predict([1, 1])
TypeError: unsupported operand type(s) for %: 'NoneType' and 'int'
```
以为是需要把 %d 改成 %s 改了过后还是报错。然后再参考网上资料。在 [stackoverflow](https://stackoverflow.com/questions/22070888/typeerror-unsupported-operand-types-for-nonetype-and-int) (原文参考) 找到了答案。
原来 python3 中，print 是一个函数。此处借用回答中的例子举例说明。
```python
print ("x:%d, prime YES") % (x)
#等同于
(print ("x:%d, prime YES")) % (x)
```
此时 print 没有返回所以你得到一个错误，同时， (x) 不是一个包含1个元素的 tuple ，只是一个值 x 。如果要使用 tuple, 应该使用 (x,)
所以正确的语句应该是：
```python
print("x:%d, prime YES" % (x,))
```
所以我将原来的代码改为：
```python
print ('1 and 1 = %d' % and_perceptron.predict([1, 1])) 
print ('0 and 0 = %d' % and_perceptron.predict([0, 0]))
print ('1 and 0 = %d' % and_perceptron.predict([1, 0]))
print ('0 and 1 = %d' % and_perceptron.predict([0, 1]))
```

<br />


### <span id ="jump_3">问题3</span> reduce 、map 等相关问题
在运行时我还遇到了一个报错：
```
NameError: name 'reduce' is not defined
```
鸭鸭帮忙百度了一下说是在 python3 里面， reduce() 函数已经被从全局名字空间里移除了，要用的话，先引入：
```python
from functools import reduce
```
然后顺利的运行成功了，但是！（一般xxx后面都需要一个转折） 打印的有一个参数是 map 显示的是：
```python
weights :<map object at 0x000000B4E15EF080>
```
这个肯定是不对的。所以查一下说，在 python2 里面，直接使用 map 就可以打印结果， 但是在 python3 里面， map 返回的结果是迭代器(iterator), 需要先转换为列表，eg:
```python
#py2
  print(map(lambda x: x + x, [1, 2, 3]))
#py3
  print(list(map(lambda x: x + x, [1, 2, 3])))
```

### 总结
以上就是所有的问题了。总结一下就是，还是要学下 python3 （泪目）。
